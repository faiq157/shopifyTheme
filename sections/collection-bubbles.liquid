{{ 'section-collection-bubbles.css' | asset_url | stylesheet_tag }}
<!-- Category Bubbles -->
<div class="collections-bubbles page-width">
  {% if section.settings.heading != blank %}
    <h2 class="collections-bubbles__heading">{{ section.settings.heading }}</h2>
  {% endif %}

  <ul class="collections-bubbles__list">
    {% assign rendered_any = false %}
    {% for block in section.blocks %}
      {% assign coll = block.settings.collection %}
      {% if coll %}
        {% assign rendered_any = true %}
        <li class="collections-bubbles__item" {{ block.shopify_attributes }}>
          <a href="{{ coll.url }}">
            {% if coll.image %}
              <img
                src="{{ coll.image | image_url: width: 160 }}"
                alt="{{ coll.title }}"
                class="collections-bubbles__img"
              >
            {% else %}
              <span class="collections-bubbles__img collections-bubbles__img--placeholder" aria-hidden="true">{{ coll.title | slice: 0, 1 }}</span>
            {% endif %}
            <span class="collections-bubbles__title">{{ block.settings.title | default: coll.title }}</span>
          </a>
        </li>
      {% endif %}
    {% endfor %}

    {% unless rendered_any %}
      {% assign featured_collections = collections | slice: 0, 6 %}
      {% for coll in featured_collections %}
        <li class="collections-bubbles__item">
          <a href="{{ coll.url }}">
            {% if coll.image %}
              <img
                src="{{ coll.image | image_url: width: 160 }}"
                alt="{{ coll.title }}"
                class="collections-bubbles__img"
              >
            {% else %}
              <span class="collections-bubbles__img collections-bubbles__img--placeholder" aria-hidden="true">{{ coll.title | slice: 0, 1 }}</span>
            {% endif %}
            <span class="collections-bubbles__title">{{ coll.title }}</span>
          </a>
        </li>
      {% endfor %}
    {% endunless %}
  </ul>
</div>

{% schema %}
{
  "name": "Categories",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop by category"
    }
  ],
  "blocks": [
    {
      "type": "category",
      "name": "Category",
      "settings": [
        { "type": "collection", "id": "collection", "label": "Collection" },
        { "type": "text", "id": "title", "label": "Title override" }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Categories",
      "blocks": [
        { "type": "category" },
        { "type": "category" },
        { "type": "category" },
        { "type": "category" },
        { "type": "category" }
      ]
    }
  ]
}
{% endschema %}
